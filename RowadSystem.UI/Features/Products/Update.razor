@* @page "/update-product/{productId:int}"
@using System.Net.Http

<h3>Update Product</h3>

<EditForm Model="@updateProductRequest" OnValidSubmit="HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="mb-3">
        <label for="productName" class="form-label">Product Name</label>
        <InputText id="productName" class="form-control" @bind-Value="updateProductRequest.Name" required />
    </div>

    <div class="mb-3">
        <label for="productDescription" class="form-label">Description</label>
        <InputTextArea id="productDescription" class="form-control" @bind-Value="updateProductRequest.Description" />
    </div>

    <div class="mb-3">
        <label for="discountId" class="form-label">Discount</label>
        <InputSelect id="discountId" class="form-select" @bind-Value="updateProductRequest.DiscountId">
            <option value="">Select Discount (Optional)</option>
            @foreach (var discount in _discountResponses)
            {
                <option value="@discount.Id">@discount.Name</option>
            }
        </InputSelect>
    </div>

    <div class="mb-3">
        <label for="brandId" class="form-label">Brand</label>
        <InputSelect id="brandId" class="form-select" @bind-Value="updateProductRequest.BrandId">
            <option value="">Select Brand</option>
            @foreach (var brand in _brandResponses)
            {
                <option value="@brand.Id">@brand.Name</option>
            }
        </InputSelect>
    </div>

    <div class="mb-3">
        <label for="categoryId" class="form-label">Category</label>
        <InputSelect id="categoryId" class="form-select" @bind-Value="updateProductRequest.CategoryId" required>
            <option value="">Select Category</option>
            @foreach (var category in _categoryResponses)
            {
                <option value="@category.Id">@category.Name</option>
            }
        </InputSelect>
    </div>
    <!-- Existing Product Images -->
    <div class="mb-3">
        <label class="form-label">Existing Images</label>
        <div class="d-flex flex-wrap">
            @foreach (var image in productDetails.Images )
            {
                <div class="m-2">
                    <img src="@image.ThumbnailUrl" alt="Product Image" class="img-thumbnail" style="width: 100px; height: 100px; object-fit: cover;" />
                    <div class="text-center mt-2">
                        <small>@image.ImageUrL</small>
                    </div>
                </div>
            }
        </div>
    </div>


    <div class="card shadow-sm mb-4 border-0">
        <div class="card-header bg-light">
            <strong>📸 Upload Product Images</strong>
        </div>
        <div class="card-body">
            <InputFile OnChange="HandleSelectedImages" multiple class="form-control" />
            @if (!string.IsNullOrEmpty(ErrorMessage))
            {
                <div class="alert alert-danger mt-3">
                    @ErrorMessage
                </div>
            }
            <div class="d-flex flex-wrap mt-3">
                @foreach (var preview in imagePreviews.Select((src, index) => new { src, index }))
                {
                    <div class="position-relative m-2" style="width: 130px; height: 130px;">
                        <img src="@preview.src" class="rounded shadow-sm w-100 h-100" style="object-fit: cover; border: 1px solid #dee2e6;" />

                        <button type="button"
                                class="btn btn-sm btn-danger position-absolute"
                                style="top: 5px; right: 5px; border-radius: 50%; padding: 0.25rem 0.5rem;"
                                @onclick="() => RemoveImage(preview.index)">
                            &times;
                        </button>
                    </div>
                }
            </div>
        </div>
    </div>

    <div class="mb-3">
        <button type="submit" class="btn btn-primary">Update Product</button>
    </div>
</EditForm>

 *@
@page "/update-product/{productId:int}"
@using System.Net.Http

<h3 class="text-center mb-4">Update Product</h3>

<EditForm Model="@updateProductRequest" OnValidSubmit="HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <!-- Form Container using Bootstrap Grid -->
    <div class="row g-3">

        <!-- Product Name and Description in Same Row -->
        <div class="col-md-6">
            <label for="productName" class="form-label fw-bold small">Product Name</label>
            <InputText id="productName" class="form-control form-control-sm" @bind-Value="updateProductRequest.Name" required />
        </div>
        <div class="col-md-6">
            <label for="productDescription" class="form-label fw-bold small">Description</label>
            <InputTextArea id="productDescription" class="form-control form-control-sm" @bind-Value="updateProductRequest.Description" rows="3" />
        </div>

        <!-- Discount and Brand in Same Row -->
        <div class="col-md-6">
            <label for="discountId" class="form-label fw-bold small">Discount</label>
            <InputSelect id="discountId" class="form-select form-select-sm" @bind-Value="updateProductRequest.DiscountId">
                <option value="">Select Discount (Optional)</option>
                @foreach (var discount in _discountResponses)
                {
                    <option value="@discount.Id">@discount.Name</option>
                }
            </InputSelect>
        </div>
        <div class="col-md-6">
            <label for="brandId" class="form-label fw-bold small">Brand</label>
            <InputSelect id="brandId" class="form-select form-select-sm" @bind-Value="updateProductRequest.BrandId">
                <option value="">Select Brand</option>
                @foreach (var brand in _brandResponses)
                {
                    <option value="@brand.Id">@brand.Name</option>
                }
            </InputSelect>
        </div>

        <!-- Category in a Full Row -->
        <div class="col-md-12">
            <label for="categoryId" class="form-label fw-bold small">Category</label>
            <InputSelect id="categoryId" class="form-select form-select-sm" @bind-Value="updateProductRequest.CategoryId" required>
                <option value="">Select Category</option>
                @foreach (var category in _categoryResponses)
                {
                    <option value="@category.Id">@category.Name</option>
                }
            </InputSelect>
        </div>

        <!-- Existing Product Images in Full Row -->
        <div class="col-12">
            <label class="form-label fw-bold small">Existing Images</label>
            <div class="d-flex flex-wrap">
                @foreach (var image in productDetails.Images)
                {
                    <div class="m-2">
                        <img src="@image.ThumbnailUrl" alt="Product Image" class="img-thumbnail" style="width: 100px; height: 100px; object-fit: cover;" />
                        <div class="text-center mt-2">
                            <small>@image.ImageUrL</small>
                        </div>
                    </div>
                }
            </div>
        </div>

        <!-- Image Upload Section in Full Row -->
        <div class="col-12">
            <div class="card shadow-sm mb-4 border-0">
                <div class="card-header bg-light">
                    <strong>📸 Upload Product Images</strong>
                </div>
                <div class="card-body">
                    <InputFile OnChange="HandleSelectedImages" multiple class="form-control form-control-sm" />
                    @if (!string.IsNullOrEmpty(ErrorMessage))
                    {
                        <div class="alert alert-danger mt-3">
                            @ErrorMessage
                        </div>
                    }

                    <div class="d-flex flex-wrap mt-3">
                        @foreach (var preview in imagePreviews.Select((src, index) => new { src, index }))
                        {
                            <div class="position-relative m-2" style="width: 120px; height: 120px;">
                                <img src="@preview.src" class="rounded shadow-sm w-100 h-100" style="object-fit: cover; border: 1px solid #dee2e6;" />

                                <button type="button"
                                        class="btn btn-sm btn-danger position-absolute"
                                        style="top: 5px; right: 5px; border-radius: 50%; padding: 0.25rem 0.5rem;"
                                        @onclick="() => RemoveImage(preview.index)">
                                    &times;
                                </button>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Submit Button in Full Row -->
        <div class="col-12 text-center mb-3">
            <button type="submit" class="btn btn-primary btn-sm w-100">Update Product</button>
        </div>

    </div> <!-- End of Grid Row -->
</EditForm>

<!-- Add some custom styling if necessary -->
<style>
    .img-thumbnail {
        object-fit: cover;
    }
</style>
